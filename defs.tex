\usepackage{xparse}
\usepackage{amsmath}

\newcommand{\bxi}{\boldsymbol{\xi}}
\newcommand{\dt}{\, {\rm d}t}
\newcommand{\dX}{\, {\rm d}\mathbf{X}}
\newcommand{\dx}{\, {\rm d}\mathbf{x}}
\newcommand{\dVblank}{\, {\rm d}V}
\newcommand{\dxi}{\, {\rm d}\bxi}
\newcommand{\deta}{\, {\rm d}\bs\eta}
\newcommand{\fr}{\underline{\nabla}}
\newcommand{\eps}{\varepsilon}

\NewDocumentCommand \snsI{ m m o }{%
    \IfNoValueTF{#3}{\underline{\mbf{#1}}_{#2}}%
    {
      \underline{\mbf{#1}}_{#2}(#3)%
    }
}

\NewDocumentCommand \stateOneN{ m }{
    \underline{#1}%
}

\NewDocumentCommand \stateTwoN{ m o }{%
    \IfNoValueTF{#2}{\stateOneN{#1}}
    {
    \stateOneN{#1}\an{#2}%
    }
}

\NewDocumentCommand \sN{ m o o }{%
    \IfNoValueTF{#3}{\stateTwoN{#1}[#2]}%
    {
    \underline{#1}(#3)\an{#2}%
    }
}

\NewDocumentCommand \dV{ o }{%
    \IfNoValueTF{#1}{\dVblank}%
    {
        \dV_{#1}
    }
}

\NewDocumentCommand \mc{ m }{%
    \mathcal{#1}%
}

\NewDocumentCommand \matD{ m m }{%
    \frac{{\rm D}#1}{{\rm D}#2}%
}

\NewDocumentCommand \D{ m m }{%
    \frac{{\rm d}#1}{{\rm d}#2}%
}

\NewDocumentCommand \kr{ m }{%
    \delta_{#1}
}

\NewDocumentCommand \tr{ m }{%
    \mbox{tr}_{\scs\omega} \left( {#1} \right)
}

\NewDocumentCommand \subm{ m }{%
    {#1}_{(m)}
}

\NewDocumentCommand \p{ m m }{%
    \frac{\partial #1}{\partial #2}%
}

\NewDocumentCommand \eref{ m }{%
    (\ref{eqn:#1})%
}

\NewDocumentCommand \sref{ m }{%
    \S\ref{sec:#1}%
}

\NewDocumentCommand \fref{ m }{%
    fig.~\ref{fig:#1}%
}

\NewDocumentCommand \Fref{ m }{%
    Figure~\ref{fig:#1}%
}

\NewDocumentCommand \an{ m }{%
    \langle {#1} \rangle%
}

\NewDocumentCommand \mbf{ m }{%
    \mathbf{#1}
}

\NewDocumentCommand \bbar{ m }{%
    \bar{\mbf{#1}}
}

\NewDocumentCommand \bs{ m }{%
    \boldsymbol{#1}
}


\NewDocumentCommand \stateOne{ m }{
    \underline{\mbf{#1}}%
}

\NewDocumentCommand \stateTwo{ m o }{%
    \IfNoValueTF{#2}{\stateOne{#1}}
    {
    \stateOne{#1}\an{#2}%
    }
}

\NewDocumentCommand \s{ m o o }{%
    \IfNoValueTF{#3}{\stateTwo{#1}[#2]}%
    {
    \underline{\mbf{#1}}({#3})\an{#2}%
    }
}

\NewDocumentCommand \stateOneI{ m m }{
    \underline{#1}_{#2}%
}

\NewDocumentCommand \stateTwoI{ m m o }{%
    \IfNoValueTF{#3}{\stateOneI{#1}{#2}}
    {
    \stateOneI{#1}{#2}\an{#3}%
    }
}

% \NewDocumentCommand \si{ m m o o }{%
%     \IfNoValueTF{#4}{\stateTwoI{#1}{#2}[#3]}%
%     {
%         \stateOneI{#1}{#2}(\mbf{#4})\an{#3}
%     }
% }

\NewDocumentCommand \scs{ m }{
    \underline{#1}%
}

\NewDocumentCommand \ds{ m }{
    {\rm d}\scs{#1}%
}

\NewDocumentCommand \smag{ m }{
    \vert\s{#1}\vert%
}

